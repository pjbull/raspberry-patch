<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Raspberry-patch : Software for the setup and administration of a cluster of raspberry pis." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Raspberry Patch | Performance</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
                <header class="inner">
          <!-- <a id="forkme_banner" href="https://github.com/pjbull/raspberry-bush">View on GitHub</a> -->

          <h1 id="project_title">Raspberry Patch</h1>
          <h2 id="project_tagline">building a cluster of raspberry pis</h2>
          <img id="forkme_banner" src="/images/g.png"/>
          	<a class="button" href="/index.html">background</a>
          	<a class="button" href="/software.html">software</a>
          	<a class="button" href="/hardware.html">hardware</a>
          	<a class="button" href="/steps.html">step-by-step</a>
          	<a class="button" href="/perf.html">performance</a>
            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/pjbull/raspberry-bush/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/pjbull/raspberry-bush/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>


    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h2 id='optimizations'>Optimizations</h2>

<p>We performed several optimizations in order to improve the performance of our cluster.</p>

<ol>
<li>We decrease the video RAM allocation from 256 Mb (out of 512 Mb total) to 16 Mb</li>

<li>We overclock the processesors to 950 MHz. Although, we attempted to to overclock the Raspberry Pis to 1,000 MHz, this caused system instability.</li>

<li>We use a Linux kernel flag to optimize the ethernet controller by not waiting for extra frames.</li>

<li>We network statically to avoid DHCP lookup.</li>

<li>We change SSH security settings to avoid extra networking overhead</li>
</ol>

<h2 id='relative_performance'>Relative Performance</h2>

<p>We compared the performance of our Raspberry Pi cluster to a Core i7 Macbook Pro for two of the CS 205 homework problems: <img alt='alt text' src='/images/mbp.png' /></p>

<h2 id='speedup_and_efficiency'>Speedup and Efficiency</h2>

<p>For one of the homework problems (computing the Mandelbrot set) we also looked at speedup and efficiency of our cluster: <img alt='alt text' src='/images/mandel_perf.png' /></p>

<h2 id='communication_latency'>Communication Latency</h2>

<p>In order to find any potential bottlenecks, we performed a pairwise profile of our nodes. This table provides pairwise communication latency in miliseconds for each pair of nodes. The takeaway: our slowest pair of nodes can start 35 message transfers in the blink of an eye.</p>
<table><thead><tr><th /><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td style='text-align: left;'>0</td><td style='text-align: left;' /><td style='text-align: left;'>8</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>7</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>1</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>10</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>6</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>7</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>2</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>7</td><td style='text-align: left;'>7</td><td style='text-align: left;'>7</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>8</td><td style='text-align: left;'>10</td><td style='text-align: left;'>7</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>3</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>10</td><td style='text-align: left;'>7</td><td style='text-align: left;'>7</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>4</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>7</td>
</tr><tr><td style='text-align: left;'>5</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>8</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td>
</tr><tr><td style='text-align: left;'>6</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>10</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>7</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>8</td><td style='text-align: left;'>10</td><td style='text-align: left;'>7</td><td style='text-align: left;'>9</td><td style='text-align: left;'>8</td><td style='text-align: left;'>10</td><td style='text-align: left;'>7</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>8</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>10</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>9</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>7</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>8</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>10</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>8</td><td style='text-align: left;'>5</td><td style='text-align: left;'>6</td><td style='text-align: left;'>7</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>11</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>6</td><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>12</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td><td style='text-align: left;'>5</td><td style='text-align: left;'>7</td>
</tr><tr><td style='text-align: left;'>13</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>10</td><td style='text-align: left;'>8</td>
</tr><tr><td style='text-align: left;'>14</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>5</td>
</tr><tr><td style='text-align: left;'>15</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' />
</tr></tbody></table>
<p>We also compare communication latency to the CS 205 cluster and an EC2 cluster setup with starcluster. For both of these clusters, we checked the performance with round robbin and fill-in. <img alt='alt text' src='/images/latency.png' /></p>

<h2 id='inverse_bandwidth'>Inverse Bandwidth</h2>

<p>We compute inverse bandwidth in megabytes per second. Not too shabby.</p>
<table><thead><tr><th /><th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th><th>11</th><th>12</th><th>13</th><th>14</th><th>15</th></tr></thead><tbody><tr><td style='text-align: left;'>0</td><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>4</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>1</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>2</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>2</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>2</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>4</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>3</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>4</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>5</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>6</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>5</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>7</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>2</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>8</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>2</td>
</tr><tr><td style='text-align: left;'>9</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>10</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>2</td>
</tr><tr><td style='text-align: left;'>11</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>12</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>13</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>14</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;'>3</td>
</tr><tr><td style='text-align: left;'>15</td><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' /><td style='text-align: left;' />
</tr></tbody></table>
<p>Here&#8217;s a comparison of the inverse bandwidth of our Raspberry Pi cluster with the CS 205 cluster and the EC2 cluster: <img alt='alt text' src='/images/invbw.png' /></p>

<h2 id='a_few_other_measures'>A Few Other Measures</h2>

<p>In terms of GFLOPs/Cu.Ft. The Raspberry patch loses out to a server rack fitted with Intel CPUs: <img alt='alt text' src='/images/pervolume.png' /></p>

<p>If we look at our power consumption, we still can&#8217;t beat out a core-i7 cluster in terms of GFLOPs/Watt: <img alt='alt text' src='/images/perwatts.png' /></p>

<p>However, on the next graph, lower is better. This is the cost to replace a node if one of the cores fails: <img alt='alt text' src='/images/nodecost.png' /></p>

<p>Finally, a victory!</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Raspberry-patch maintained by <a href="https://github.com/pjbull">pjbull</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
